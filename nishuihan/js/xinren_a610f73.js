"use strict";nie.define("main",function(){function t(t,e,n){function i(){if(o[0]){var t=0;t=o[0].scrollTop>o[0].scrollHeight-o[0].clientHeight?1:o[0].scrollTop<0?0:o[0].scrollTop/(o[0].scrollHeight-o[0].clientHeight);var i=$(e).height()-$(n).height();$(n).css({top:i*t+"px"})}}var o=$(t);o.off("scroll"),i(),o[0]&&o[0].scrollHeight>o[0].clientHeight?($(e).show(),$(n).show(),o.on("scroll",i)):($(e).hide(),$(n).hide())}var e=nie.require("common");e.init();var n,i=nie.require("nie.util.login2"),o="https://n.res.netease.com/pc/qt/20180515161140/css/login2_daea03e.css",c="https://ssl.hi.163.com/file_mg/public/nsh/giftcode/";new Vue({el:".content",data:{step:"step1",verifycode:"",username:"",giftcode:"",rulesFold:!0},methods:{initApp:function(){var t=this;this.step="step5",this.$nextTick(function(){t.initCaptcha()})},updateStatus:function(){var t=this;$.ajax({url:c+"send/gift/gw/pc/"+t.verifycode,dataType:"jsonp",xhrFields:{withCredentials:!0},success:function(e){-1==e.code?(t.step="step2",t.$nextTick(function(){t.loginInit()})):1==e.code&&e.giftcode?(t.giftcode=e.giftcode,t.step="step3",t.$nextTick(function(){t.initClipboard(1)})):e.giftcode?(t.giftcode=e.giftcode,t.step="step4",t.$nextTick(function(){t.initClipboard(2)})):alert(e.msg||"\u670d\u52a1\u5668\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01")},error:function(){alert("\u670d\u52a1\u5668\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01")}})},getStatus:function(){var t=this;$.ajax({url:c+"get/gift/login",dataType:"jsonp",xhrFields:{withCredentials:!0},success:function(e){-1==e.code?(t.step="step2",t.$nextTick(function(){t.loginInit()})):e.code>=0?t.initApp():alert(e.msg||"\u670d\u52a1\u5668\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01")},error:function(){alert("\u670d\u52a1\u5668\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01")}})},initClipboard:function(t){var e=new ClipboardJS("#copyBtn"+t);e.on("success",function(t){t.clearSelection(),alert("\u590d\u5236\u6210\u529f\uff01")}),e.on("error",function(){alert("\u5f53\u524d\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u6b64\u529f\u80fd\uff0c\u8bf7\u624b\u52a8\u9009\u62e9\u590d\u5236")})},setScrollbar:function(){t(".content-wrap-inner",".scroll-bar",".scroll-thumb")},unfoldRules:function(){this.rulesFold=!1,this.setScrollbar()},loginInit:function(){var t=this;n=i.create({holder:"#login",css:o,success:function(){i.fn.isLogin(function(e){e&&(t.username=i.fn.getUserName(),t.initApp())})}})},logout:function(){i.fn.logOut(function(){window.location.reload()})},initCaptcha:function(){var t=this;document.getElementById("captcha")&&window.initNECaptcha({captchaId:"bce310d3656042e988e133b9ad47bd10",element:"#captcha",mode:"float",width:360,onReady:function(){},onVerify:function(e,n){return e?(console.error("\u9a8c\u8bc1\u5931\u8d25"),void(t.verifycode="")):(t.verifycode=n.validate,void t.updateStatus())}},function(){},function(t){console.error("\u9a8c\u8bc1\u7801\u521d\u59cb\u5316\u5931\u8d25\u5904\u7406\u903b\u8f91\uff0c\u4f8b\u5982\uff1a\u63d0\u793a\u7528\u6237\u70b9\u51fb\u6309\u94ae\u91cd\u65b0\u521d\u59cb\u5316",t)})}},mounted:function(){function t(t,e,n){var i=setInterval(function(){t[e]&&(clearInterval(i),n&&n())},200)}var e=this;t(window,"Login",function(){$.ajax({url:c+"get/gift/login",dataType:"jsonp",xhrFields:{withCredentials:!0},success:function(t){t.code>=0&&(e.username=i.fn.getUserName())},error:function(){}})}),this.setScrollbar()}});var s=$(".share-list"),r=null;s.hover(function(){r&&clearTimeout(r),$("#Mshare").fadeIn(100)},function(){r=setTimeout(function(){$("#Mshare").fadeOut()},200)})});